<!DOCTYPE html>
<html lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>모바일 웨딩 초대장</title>
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="anim.css">
    <head>
    <script type="text/javascript" src="https://oapi.map.naver.com/openapi/v3/maps.js?ncpClientId=vu1xmgid7i"></script>
    <script src="./count.js"></script>
    <script src="./particle.js"></script>
    <style>
        /* Add this CSS code to your existing <style> tag */
        section {
            opacity: 0;
            transform: translateY(5rem);
            transition: opacity 0.5s, transform 0.5s;
        }
        section.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .scroll-animation{
            display: flex;
        }
    </style>
    <script>
        const ARRAY_OF_IMG_LINKS = [
            "./imgs/wp000a.jpg",
            "./imgs/wp000b.jpg",
            "./imgs/wp000c.jpg",
            './imgs/wp000d.jpg',
            './imgs/wp000e.jpg',
            './imgs/wp000f.jpg',
            './imgs/wp000g.jpg',
            './imgs/wp000h.jpg',
            './imgs/wp000i.jpg',
            './imgs/wp000j.jpg',
            './imgs/wp000k.jpg',
            './imgs/wp000l.jpg'
        ];
        // Add this JavaScript code to your existing <script> tag or in a separate script file
        document.addEventListener("DOMContentLoaded", () => {
            var sections = document.querySelectorAll("section");
            var windowHeight = window.innerHeight;
    
            function checkSectionVisibility() {
                for (var i = 0; i < sections.length; i++) {
                    var section = sections[i];
                    var sectionTop = section.getBoundingClientRect().top;
    
                    if (sectionTop - windowHeight <= 0) {
                        section.classList.add("visible");
                    }
                }
            }
            window.addEventListener("scroll", checkSectionVisibility);
            checkSectionVisibility();
        });
        document.addEventListener("DOMContentLoaded", ()=>{
            const canvas = document.getElementById('canvas');
            setCanvasSize();
            function setCanvasSize() {
                canvas.width = document.documentElement.clientWidth;
                canvas.height = document.documentElement.clientHeight - 100;
                console.log(canvas.width, canvas.height);
            }
            window.onresize = function(e) {
                setCanvasSize();
            }
            const cnt = document.documentElement.clientWidth/25;
            twinkle(cnt, canvas);
        });


        document.addEventListener("DOMContentLoaded", () => {
            const targetCoord = [37.5140508,127.0372835];
            const windowWidth = document.documentElement.clientWidth;
            const targetZoom = windowWidth < 768 ? 15 : 16;

            var mapOptions = {
                center: new naver.maps.LatLng(...targetCoord),
                zoom: targetZoom
            };
            var map = new naver.maps.Map('map', mapOptions);
            var marker = new naver.maps.Marker({
                position: new naver.maps.LatLng(...targetCoord),
                map: map
            });
            var polygon = new naver.maps.Polygon({
                map: map,
                paths: [
                    [127.0371685,37.5141248],
                    [127.0373655,37.5141848],
                    [127.037490,37.5138848],
                    [127.0372985,37.5138248],
                ],
                fillColor: '#13F',
                fillOpacity: 0.4,
                strokeWeight: 2,
                strokeColor: '#13F'
            });

        });

        document.addEventListener("DOMContentLoaded", () => {
            const scrollAnimationElement = document.querySelector(".scroll-animation");
            ARRAY_OF_IMG_LINKS.forEach((link) => {
                const divElement = document.createElement("div");
                divElement.classList.add("gallery_content");
                divElement.style.backgroundImage = `url(${link})`;
                
                // const divElementBlured = document.createElement("div");
                // divElementBlured.classList.add("gallery_content");
                // divElementBlured.classList.add("gallery_content_blured");
                // divElementBlured.style.backgroundImage = `url(${link})`;
                // divElement.appendChild(divElementBlured);
                scrollAnimationElement.appendChild(divElement);

            });
        });

        document.addEventListener("DOMContentLoaded", updateCountdown);
        const getOpacity = (progress) =>{
            const THREARSHOLD = 0.15;
            return progress > THREARSHOLD ? (progress - THREARSHOLD) * 3 : 0;
        }
        window.addEventListener('scroll', () => {
            const IMG_WIDTH = document.documentElement.clientWidth > 1024 ? 1024 : document.documentElement.clientWidth;
            const IMG_COUNTS = ARRAY_OF_IMG_LINKS.length;
            const IMG_TOTAL_LENGTH = IMG_WIDTH * IMG_COUNTS;
            const bufferDivElement = document.querySelector('.bufferDiv');
            bufferDivElement.style = `width : ${document.documentElement.clientHeight/2}px`;
            
            const MIN_IMG_HEIGHT = window.innerHeight - 100;
            const IMG_HEIGHT = (800 > MIN_IMG_HEIGHT ? MIN_IMG_HEIGHT : 800)
            var scrollPosition = window.scrollY;
            var element = document.querySelector('.scroll-animation');

            const aniStart = document.querySelector('.ani_start').getBoundingClientRect().top;
            const aniEnd = document.querySelector('.ani_end').getBoundingClientRect().top;

            // Calculate the animation progress based on scroll position
            //var animationProgress = scrollPosition / (document.documentElement.scrollHeight - window.innerHeight);
            let topPos = aniStart > 0 ? aniStart : 0;
            let marginTop = document.documentElement.clientHeight/2 - IMG_HEIGHT/2;
            let animationProgress = (document.documentElement.clientHeight - (aniStart + marginTop)) / (aniEnd - (IMG_HEIGHT/1.5) - aniStart);
            animationProgress = animationProgress > 1 ? 1 : animationProgress;
            // Adjust the animation keyframes based on the animation progress
            var keyframeOpacity = 1 - animationProgress * 0.5;
            var keyframeRight = -IMG_TOTAL_LENGTH + animationProgress * IMG_TOTAL_LENGTH;

            // Apply the adjusted keyframe values to the animation
            element.style = `
                position: fixed;
                width: ${IMG_TOTAL_LENGTH}px;
                height: ${IMG_HEIGHT}px;
                margin-top: ${marginTop}px;
                right: ${keyframeRight}px;
                top: ${topPos}px;
            `;
            document.querySelector(".ani_start").style = `height: ${IMG_TOTAL_LENGTH + marginTop}px`;
            // document.body.style = `
            //     background: linear-gradient(to bottom right, rgba(20,20,10,${getOpacity(animationProgress)}), rgba(0,0,10,${getOpacity(animationProgress)}));
            // `;
        });
    </script>
</head>
<body>
    <header>
        <canvas id="canvas"></canvas>
        <div class="titleBg">
            <div class="titleGradient">
                <section style="padding-top:4.3rem;">
                    <div>
                        <h1 class="nametitle">이정욱 · 정지현</h1>
                    </div>
                    <div style="font-size: 2rem;font-family: 'Noto Sans KR ExtraLight';line-height: 1.3rem;">
                        <span>24</span><span class="middle">04</span><span>28</span>
                    </div>
                        <h2 style="font-family: 'Noto Sans KR Thin';">SUNDAY</h2>
                    <div class="timedetails">
                        <span>빌라드지디 강남 11:30 AM</span>
                    </div>
                </section>
            </div>
            <section style="padding-top:35rem;">
                <div id="countdown">
                    <div class="subcd">
                        <span>DAYS</span>
                    </div>
                    <div class="subcd">
                        <span>HOURS</span>
                    </div>
                    <div class="subcd">
                        <span>MIN</span>
                    </div>
                    <div class="subcd">
                        <span>SEC</span>
                    </div>
                </div>
                <div id="countdown">
                    <div class="subcd cnt" id="cddays">
                    </div>
                    <div class="subcd cnt" id="cdhours">
                    </div>
                    <div class="subcd cnt" id="cdminutes">
                    </div>
                    <div class="subcd cnt" id="cdseconds">
                    </div>
                </div>
            </section>
            <div>
                <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
                    <defs>
                        <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
                    </defs>
                    <g class="parallax">
                        <use xlink:href="#gentle-wave" x="48" y="0" fill="rgba(255,250,245,0.7" />
                        <use xlink:href="#gentle-wave" x="48" y="3" fill="rgba(255,215,155,0.5)" />
                        <use xlink:href="#gentle-wave" x="48" y="5" fill="rgba(255,161,195,0.3)" />
                        <use xlink:href="#gentle-wave" x="48" y="7" fill="rgb(255,250,245)" />
                    </g>
                </svg>
            </div>
        </div>
    </header>
    <main>
        <section class="section_head">
            <h1 class="greetings">초대합니다</h1>
            <h2>두 사람이 문구 초대문구</h2>
            <h2>빛나는 이날에</h2>
            <h2>같이 축복해주세요</h2>
            <div class="famcon">
                <div class="subfam">
                    <span>이상의</span><br/>
                    <span>유예순</span><br/>
                </div>
                <div class="subfam" style="color:#a88">
                    <span>의</span>
                </div>
                <div class="subfam" style="color:#a88">
                    <span>아들</span>
                </div>
                <div class="subfam" style="font-weight: bold;">
                    <span>정욱</span>
                </div>
            </div>
            <div>
                <span>……</span>
            </div>
            <div class="famcon">
                <div class="subfam">
                    <span>정병선</span><br/>
                    <span>장영숙</span><br/>
                </div>
                <div class="subfam" style="color:#a88">
                    <span>의</span>
                </div>
                <div class="subfam" style="color:#a88">
                    <span>딸</span>
                </div>
                <div class="subfam" style="font-weight: bold;">
                    <span>지현</span>
                </div>
            </div>
            <div class="splitter">
            </div>
        </section>
        <section class="section_head">
            <h1 class="greetings">일시</h1>
            <h2>2024년 4월 28일 일요일</h2>
            <div class="calendar">
                <div class="calendar-header">
                    <div class="calendar-day highlight">일</div>
                    <div class="calendar-day">월</div>
                    <div class="calendar-day">화</div>
                    <div class="calendar-day">수</div>
                    <div class="calendar-day">목</div>
                    <div class="calendar-day">금</div>
                    <div class="calendar-day">토</div>
                </div>
                <div class="calendar-body">
                    <div class="calendar-day"></div>
                    <div class="calendar-day">1</div>
                    <div class="calendar-day">2</div>
                    <div class="calendar-day">3</div>
                    <div class="calendar-day">4</div>
                    <div class="calendar-day">5</div>
                    <div class="calendar-day">6</div>
                    <div class="calendar-day highlight">7</div>
                    <div class="calendar-day">8</div>
                    <div class="calendar-day">9</div>
                    <div class="calendar-day">10</div>
                    <div class="calendar-day">11</div>
                    <div class="calendar-day">12</div>
                    <div class="calendar-day">13</div>
                    <div class="calendar-day highlight">14</div>
                    <div class="calendar-day">15</div>
                    <div class="calendar-day">16</div>
                    <div class="calendar-day">17</div>
                    <div class="calendar-day">18</div>
                    <div class="calendar-day">19</div>
                    <div class="calendar-day">20</div>
                    <div class="calendar-day highlight">21</div>
                    <div class="calendar-day">22</div>
                    <div class="calendar-day">23</div>
                    <div class="calendar-day">24</div>
                    <div class="calendar-day">25</div>
                    <div class="calendar-day">26</div>
                    <div class="calendar-day">27</div>
                    <div class="calendar-day ddayhighlight">28</div>
                    <div class="calendar-day">29</div>
                    <div class="calendar-day">30</div>
                    <div class="calendar-day"></div>
                    <div class="calendar-day"></div>
                    <div class="calendar-day"></div>
                    <div class="calendar-day"></div>
                </div>
            </div>
            <br/>
            <div class="splitter">
            </div>
        </section>
        <section>
            <div id="ddays">
            </div>
        </section>
        <section style="margin:3rem 0rem">
            <h1 class="greetings section_head">오시는길</h1>
            <div id="map" style="width:100%;height:400px;"></div>
            <br/>
            <div class="splitter">
            </div>
        </section>
        <section style="margin:3rem 0rem">
            <h1 class="greetings section_head">마음보내실곳</h1>
            <p>계좌정보...</p>
            <br/>
            <div class="splitter">
            </div>
        </section>
        <section style="margin-top: 2rem;">
            <h1 class="greetings section_head">갤러리</h1>
        </section>
        <div class="ani_start">
            <div class="scroll-animation">
                <div class="bufferDiv">&nbsp;</div>
                <div class="scroll-animation__content">
                </div>
            </div>
        </div>
            
        <div class="ani_end"></div>
    </main>
    
</body>
</html>
